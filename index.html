<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario-direccion</title>
</head>
<body>
  <p>Inserta direcci√≥n de renta?:</p>
  <form >
    <label for="city">Ciudad:</label>
    <select onchange="getId()" id="city" name="city"></select>
    <label for="municipio">Municipio:</label>
    <select onclick="getIdSector()" id="municipio" name="municipio"></select>
    <label for="sector">Sector:</label>
    <select id="sector" name="sector"></select>
    
    <script>
      function getIdSector(){
        const idMunicipio = document.getElementById('municipio').value;
        console.log(idMunicipio);
        const SECTOR_DATA = './JSON/sectores.json';
        const selectSectores = document.querySelector("#sector");
        
        fetch(SECTOR_DATA)
          .then((response) => response.json())
          .then((sectores) => {
            const HTMLResponseSector = sectores.map((element, x) => 
            (element.municipio_id == idMunicipio 
            ?
            '<option value='+element.municipio_id+' id='+element.provincia_id+' >'+element.sector+'</option>'
            :
            '')
          );
          selectSectores.innerHTML = HTMLResponseSector;
            console.log(HTMLResponseSector);
          });   
      }
    
      function getId(){
        const idCiudad = document.getElementById('city').value;
        console.log(idCiudad);
        const MUNI_DATA = './JSON/municipios.json';
        const selectMunicipios = document.querySelector("#municipio");
        
        fetch(MUNI_DATA)
          .then((response) => response.json())
          .then((municipios) => {
            const HTMLResponseMuni = municipios.map((element, x) => 
            (element.provincia_id == idCiudad 
            ?
            '<option value='+element.municipio_id+' id='+element.provincia_id+' >'+element.municipio+'</option>'
            :
            '')
          );
            selectMunicipios.innerHTML = HTMLResponseMuni;
            console.log(HTMLResponseMuni);
          });   
      }
      const PROVI_DATA = './JSON/provincias.json';
      const select = document.querySelector("#city");
      fetch(PROVI_DATA)
        .then((response) => response.json())
        .then((provincias) => {
          const HTMLResponseProvi = provincias.map((element, x) =>
          '<option value='+element.provincia_id+' id='+element.provincia_id+' >'+element.provincia+'</option>' );
          select.innerHTML = HTMLResponseProvi;
          console.log(HTMLResponseProvi);
        }); 
    </script>
    <br>
    <br>
    <!--
      <label for="favcolor">Select your favorite color:</label>
      <input type="color" id="favcolor" name="favcolor">
    <br>
      <label for="email">Enter your email:</label>
      <input type="email" id="email" name="email">
    <br>
      <label for="phone">Enter your phone number:</label>
      <input type="tel" id="phone" name="phone" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}">
    <br>
    -->
      <button type="button" onclick="getId()">Summit</button>
    </form>

</body>
</html>